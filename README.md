# Image denoising in photon-counting CT using PFGM++ with hijacked regularized sampling<br>

Pytorch implementation of the paper [Image denoising in photon-counting CT using PFGM++ with hijacked regularized sampling](https://arxiv.org/abs/)<br>
by Dennis Hein, Staffan Holmin, Timothy Szczykutowicz, Jonathan S Maltz, Mats Danielsson, and Mats Persson

Abstract: *Deep learning (DL) has proven to be an important tool for high quality image denoising in low-dose and photon-counting CT. However, DL models are usually trained using supervised methods, requiring paired data that may be difficult to obtain in practice. Physics-inspired generative models, such as score-based diffusion models, offer a unsupervised means of solving a wide range of inverse problems via posterior sampling. The latest in this family are Poisson flow generative models PFGM++ which, inspired by electrostatics, treat the $N$-dimensional data as positive electric charges in a $N+D$-dimensional augmented space. The electric field lines generated by these charges are used to find an 
invertible mapping, via an ordinary differential equation, between an easy-to-sample prior and the data distribution of interest. In this work, we propose a method for CT image denoising based on PFGM++ that does not require paired training data. To achieve this, we adapt PFGM++ for solving inverse problems via posterior sampling, by hijacking and regularizing the sampling process. Our method incorporates score-based diffusion models (EDM) as a special case as $D\rightarrow \infty$, but additionally allows a robustness-rigidity trade-off by varying $D$. The network is efficiently trained on randomly extracted patches from clinical normal-dose CT images. The proposed method demonstrates promising performance on clinical low-dose CT images and clinical images from a prototype photon-counting system.*

## Outline
This implementation is build upon the [PFGM++](https://github.com/Newbeeer/pfgmpp) repo which in turn builds on the [EDM](https://github.com/NVlabs/edm) repo. For transfering hyperparameters from EDM using the $r=\sigma\sqrt{D}$ formula, please see [PFGM++](https://github.com/Newbeeer/pfgmpp). Checkpoints for the [Mayo low-dose CT dataset](https://www.aapm.org/grandchallenge/lowdosect/) are provided in the [checkpoints](#checkpoints) section. (this is a good section to include updates to algorithm)

## Training PFGM++

## Image denoising using PFGM++

## Checkpoints

## Preparing datasets 

## The instructions for set-ups from EDM repo
